---
layout: layout.njk
title: Index
url: /
---

<section>
    <h1 class="title">Glossary Search</h1>

    <input
        class="input"
        autofocus
        autocomplete="off"
        type="search"
        id="search"
        placeholder="Use a keyword to describe a fruit or vegetable..."
    />
</section>
<section>
    <ol id="results">
        <li data-noresult style="display: none;">
            No results found
        </li>
        {% for tag, posts in collections %} {% if tag != "all" %} {% for post in
        posts %}
        <li data-result="{{ tag }}" style="display: none;">
            {{ post.data.title }}
            {{ post.data.url }}
        </li>
        {% endfor %} {% endif %} {% endfor %}
    </ol>
</section>

<script>
    const otherResults = (selected) => {
        const allResults = [...document.querySelectorAll('#results li')]
        return allResults.filter((result) => !selected.includes(result))
    }

    const showAll = (elements) => {
        elements.forEach((el) => (el.style.display = 'block'))
    }

    const hideAll = (elements) => {
        elements.forEach((el) => (el.style.display = 'none'))
    }

    const allTerms = [
        ...document.querySelectorAll('#results [data-result]'),
    ].map((result) => {
        return result.dataset.result
    })

    const search = document.getElementById('search')
    search.addEventListener('keyup', (e) => {
        const matchingIndex = allTerms.findIndex((term) => {
            const input = e.currentTarget.value
            if (!input) return false
            return term.includes(e.currentTarget.value)
        })

        const matchingTerm = allTerms[matchingIndex]
        let selected = [
            ...document.querySelectorAll(`[data-result=${matchingTerm}]`),
        ]

        if (selected.length == 0) {
            selected = [...document.querySelectorAll('[data-noresult]')]
        }

        showAll(selected)
        hideAll(otherResults(selected))
    })
</script>
